Start by writing lexer for grammar 1 (easy)
Then, write parser for grammar 1
Then specify more advanced grammar, grammar 2, write a lexer for that grammar and write a pre-processor that targets grammar 1